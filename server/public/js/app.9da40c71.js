(function(e){function t(t){for(var r,s,c=t[0],i=t[1],u=t[2],p=0,d=[];p<c.length;p++)s=c[p],o[s]&&d.push(o[s][0]),o[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var i=n[c];0!==o[i]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),o=n.n(r);o.a},"0ed6":function(e,t,n){"use strict";var r=n("1039"),o=n.n(r);o.a},1039:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("7f7f");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("RequestsComponent")],1)},a=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"topnav"},[r("img",{staticClass:"topimg",attrs:{src:n("ccbe")}}),r("div",{staticClass:"titleText ml-3 text-x1 text-grey-darker",attrs:{href:"#"}},[e._v("Lightning Stream Media Request")]),r("div",{staticClass:"topnav-right"},[r("a",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-faq",modifiers:{"modal-faq":!0}}],staticClass:"btn-sm",attrs:{href:"#"}},[e._v("FAQ")]),r("b-modal",{ref:"faqModal",attrs:{id:"modal-faq","ok-only":"",cenetered:"",scrollable:"",title:"FAQ"}},[r("p",{staticClass:"my-4"},[r("b",[e._v("What is this?")])]),r("p",{staticClass:"my-4"},[e._v("Lorum Ipsem Bitch")]),r("p",{staticClass:"my-4"},[r("b",[e._v("What does it cost?")])]),r("p",{staticClass:"my-4"},[e._v("100 Satoshis per second. Thats like 0.4 cents or something.")])])],1)]),r("body",{staticClass:"jBod"},[r("div",{staticClass:"form-group"},[r("label",{staticStyle:{color:"white"}},[e._v("YouTube Video URL")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter a YouTube URL"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}})]),r("div",{staticClass:"form-group"},[r("label",{staticStyle:{color:"white"}},[e._v("Number of seconds")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.seconds,expression:"seconds"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter # of seconds to play"},domProps:{value:e.seconds},on:{input:function(t){t.target.composing||(e.seconds=t.target.value)}}})]),r("input",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-tall",modifiers:{"modal-tall":!0}}],staticClass:"btn btn-primary",attrs:{type:"submit",value:"Submit"},on:{click:e.createRequest}}),r("b-modal",{ref:"requestModal",attrs:{id:"modal-tall","ok-only":"",centered:"",scrollable:"",title:"Lightning invoice"}},[r("p",{staticClass:"my-4"},[e._v(e._s(this.invoice))]),r("hr"),r("p",[e.showRequestQR?r("qrcode",{attrs:{value:e.invoice,options:{width:200}}}):e._e()],1)]),r("hr"),e.error?r("p",{staticClass:"error"},[e._v(e._s(e.error))]):e._e()],1)])},c=[],i=(n("96cf"),n("3b8d")),u=n("f499"),l=n.n(u),p=n("cebc"),d=n("795b"),f=n.n(d),h=n("d225"),m=n("b0b4"),g=n("7338"),v=n.n(g),b=n("6c36"),R=10,_=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_SERVER_PORT||8086,w=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_SERVER_HOST||"localhost",y="http://".concat(w,":").concat(_,"/api/requests/"),x=(Object({NODE_ENV:"production",BASE_URL:"/"}).OPENNODE_APIKEY,Object({NODE_ENV:"production",BASE_URL:"/"}).OPENNODE_APIKEY,function(){function e(){Object(h["a"])(this,e)}return Object(m["a"])(e,null,[{key:"getRequests",value:function(){return new f.a(function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get(y);case 3:r=e.sent,o=r.data,t(o.map(function(e){return Object(p["a"])({},e,{createdAt:new Date(e.createdAt)})})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"insertRequest",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=R,t=b.inHTMLData(t),r={"Content-Type":"application/json",Authorization:"bd5ecb21-6fba-4cfa-949c-a5c70149ad27"},o='{ "amount": '.concat(n,', "callback_url": "http://').concat(w,":").concat(_,'/api/requests/update" }'),console.log("time to do some lightning!"),e.abrupt("return",v.a.post("https://dev-api.opennode.co/v1/charges",o,{headers:r}).then(function(e){return 201===e.status&&(console.log("new charge_id: ".concat(e.data.data.id)),v.a.post(y,{video:t,charge_id:e.data.data.id})),console.log(e),console.log("insertRequest returning: ".concat(e.data.data.lightning_invoice.payreq)),e.data.data.lightning_invoice.payreq}).catch(function(e){console.log(e)}));case 7:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"deletePost",value:function(e){return v.a.delete("".concat(y).concat(e))}},{key:"getImageCost",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(postCostUrl);case 2:return t=e.sent,console.log("getImageCost: ".concat(l()(t.data))),e.abrupt("return",l()(t.data));case 5:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()}]),e}()),O=x,E={name:"RequestsComponent",title:function(){return"Lightning Stream"},data:function(){return{requests:[],error:"",text:"",seconds:"",invoice:"Loading...",showRequestQR:!1,requestCost:"100"}},sockets:{connect:function(){console.log("client connected to socket")},disconnect:function(){console.log("client disconnected from socket")},message:function(e){console.log("socket message: ".concat(e)),this.text===e.message&&this.closeRequestPopup()},captionMsg:function(e){console.log("socket message: ".concat(e)),this.getMostRecentCaption(),this.getCaptionCost(),this.closeCaptionPopup(),this.inputCaption=""}},created:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return document.title="Lightning Stream",e.prev=1,e.next=4,O.getRequests();case 4:this.requests=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.error=e.t0.message;case 10:case"end":return e.stop()}},e,this,[[1,7]])}));function t(){return e.apply(this,arguments)}return t}(),methods:{createRequest:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.error="",this.invoice="Loading...",this.showRequestQR=!1,t=!1,n="https://api.streamelements.com/kappa/v2/songrequest/youtube?videoId="+this.text,e.next=7,v.a.get(n).then(function(e){200==e.status&&(t=!0)}).catch(function(e){r.invoice=e});case 7:if(e.sent,!t){e.next=18;break}return this.showRequestQR=!0,e.next=12,O.insertRequest(this.text);case 12:return this.invoice=e.sent,e.next=15,O.getRequests();case 15:this.requests=e.sent,e.next=19;break;case 18:this.invoice="Please enter a valid YouTube Video URL";case 19:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),deleteRequest:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O.deleteRequest(t);case 2:return e.next=4,O.getRequests();case 4:this.requests=e.sent;case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),closeRequestPopup:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.requestModal.hide();case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},q=E,k=(n("0ed6"),n("2877")),C=Object(k["a"])(q,s,c,!1,null,"286906f5",null),j=C.exports,P={name:"app",components:{RequestsComponent:j}},S=P,N=(n("034f"),Object(k["a"])(S,o,a,!1,null,null,null)),A=N.exports,L=n("dfcf"),V=n("5132"),T=n.n(V),U=(n("4989"),n("ab8b"),n("9f7b")),M=n.n(U),D=n("d56f"),B=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_SERVER_HOST||"localhost",I=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_SERVER_PORT||8081;console.log("Frontend port: ".concat(I)),console.log("Frontend host: ".concat(B)),r["a"].component("qr-code",L["a"]),r["a"].component(D["a"].name,D["a"]),r["a"].use(M.a),console.log("SocketIO listening on: ".concat(I)),r["a"].use(new T.a({debug:!0,connection:"http://".concat(B,":").concat(I)})),r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(A)}}).$mount("#app")},"64a9":function(e,t,n){},ccbe:function(e,t,n){e.exports=n.p+"img/lightningEmojiSmall.f9bc3d2f.png"}});
//# sourceMappingURL=app.9da40c71.js.map